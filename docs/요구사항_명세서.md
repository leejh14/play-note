# PlayNote 요구사항 & 유즈케이스 (v1.4)

## 0. 목표

동네 친구들과 하는 고정 컨텐츠(롤 내전/풋살)를 **세션 단위로 생성 → 참여 관리 → 팀 나누기 → 기록(댓글/이미지) → 롤은 통계 집계**까지 제공하는 서비스.

---

## 1. 핵심 원칙(결정사항)

- **로그인 없이 사용 가능**
- 링크는 **단체 톡방(1개 고정)** 에 공유하며, 그 단톡방 멤버가 **잠재 참가자 풀**이다.
- 초대는 **세션 단위 초대 링크(토큰)** 형태
- **링크 가진 사람 모두 수정/삭제 가능(editor)**
- 개발자/운영을 위한 **Admin token**이 별도로 존재하며, Admin은 추가 운영 권한을 가진다.
- 세션 생성 시 **날짜/시간은 하나만 정해서 생성** (후보 투표 없음)
- 기록은
  - **댓글(텍스트 전용)** 로 커뮤니티 활성화
  - **이미지는 댓글에 첨부 불가** 이며, 별도 **기록/첨부(Attachments)** 영역에 업로드
- 이미지 업로드는 **세션당 최대 10장(롤/풋살 공통)**

---

## 2. 도메인/용어 정의

- **Friend(친구)**: 동네 친구 정보(전역 주소록). 통계 집계의 기준 단위.
- **Content(컨텐츠)**: 고정 템플릿 (예: 롤 내전, 풋살)
- **Session(세션)**: 특정 날짜/시간에 진행되는 1회 모임
- **Roster(로스터)**: 세션 참가자 확정 리스트
- **Team(A/B)**: 세션에서 한 번 나누는 사람 팀(롤/풋살 공통)
- **Match(매치)**: 롤 세션 안에서 진행되는 1판(세션당 1..N)
- **Side(Blue/Red)**: LoL 게임 내 진영(매치마다 변경 가능)
- **Comment(댓글)**: 텍스트 전용 커뮤니티 기록
- **Attachment(첨부/기록 이미지)**: 댓글과 분리된 이미지 기록(세션/매치에 귀속)

---

## 3. Friend(전역 주소록) 정책

- Friend 목록은 **서비스 전역(단일 주소록)** 으로 관리한다.
- 저장 필드(개념)
  - 이름/표시명
  - 닉네임/별칭(aliases)
  - (가능하면) Riot ID (gameName / tagLine)
- Friend는 통계/매치 기록과 연결되므로, 기본 삭제 대신 **아카이브(비활성화)** 를 권장한다.

---

## 4. 세션 상태/플로우

### 4.1 세션 생성

- 컨텐츠 선택 후, **날짜/시간 1개 확정값**으로 세션 생성
- 세션 링크를 단톡방에 공유

### 4.2 진행 확정(트리거)

- 세션 상세에서 **진행 확정(Confirm)** 버튼을 누르면 세션이 “진행 확정” 상태가 된다.
- 이 이후 팀/매치 준비를 본격적으로 진행한다.

### 4.3 참가자 확정(로스터 잠금)

- 세션 상세에서 **참가자 확정(Lock roster)** 버튼으로 로스터를 확정한다.
- 로스터 확정 후에 팀 나누기 및 (롤의 경우) 매치 준비가 진행된다.

### 4.4 로스터 변경 규칙(결정사항)

- **기록 이미지(Attachment)를 업로드하기 전까지** 로스터/팀/라인 구성을 변경할 수 있다.
- **Attachment가 1장이라도 업로드되면 잠김** (기본적으로 변경 제한)
- **Admin은 잠금 해제(Unlock) 가능**

---

## 5. 참여 관리(Attendance)

- 링크로 접근한 사람은 세션에서 자신의 상태를 **참가/불참/미정**으로 설정할 수 있다.
- 한 사람이 대신 참가자 상태를 관리할 수도 있다(권한이 동일하게 열려 있음).
- 기본 인원 대비 참가 인원 카운트 표시

---

## 6. 팀 나누기(롤/풋살 공통)

- 세션에서 **한 번** Team A / Team B로 사람 팀을 나눈다.
- 풋살: 팀만 나누고 라인은 없다.
- 롤: 팀을 나눈 뒤, 매치 시작 전 라인을 결정한다.
- **풋살 팀 나누기는 세션 단위 1회**로 고정한다.

---

## 7. 롤 내전(LoL) 세부 요구사항

### 7.1 세션 내 Match 1..N

- 롤 세션 안에는 **Match가 여러 개** 생길 수 있다.

### 7.2 팀 프리셋 복사

- 세션에서 만든 Team A/B 구성을 **Match 생성 시 복사**해서 시작한다.

### 7.3 라인/챔피언

- 라인은 세션이 “진행 확정”되고 매치에 들어가기 전에 참가자들이 결정한다.
- 챔피언은 **수동 입력 허용** (MVP)

### 7.4 Team(A/B) vs Side(Blue/Red) 분리

- Team A/B는 “사람 팀”
- Blue/Red는 “게임 진영”이며 **매치마다 변경될 수 있다**
- A↔Blue/Red 매핑 및 승/패는 **스샷을 기준으로 확정**한다.

### 7.5 롤 기록 이미지(지원 범위 고정)

- MVP에서 롤 기록 이미지는 **게임 종료 결과창 1종만 지원**
- 따라서 업로드되는 롤 이미지는 항상 **게임 종료 결과창 스샷**이다.

### 7.6 스샷 기반 확정 및 집계

- 결과창 스샷 업로드 → 자동 추출 시도(승/패/진영) → 사용자가 확인/수정 → **확정**
- **확정된 Match만 통계 집계에 포함**

---

## 8. 기록/커뮤니티

### 8.1 댓글(텍스트 전용)

- 댓글은 커뮤니티 활성화를 위한 **텍스트 전용** 기능이다.
- 댓글에 이미지는 첨부할 수 없다.

### 8.2 첨부(이미지 기록)

- 이미지 업로드는 별도 **Attachments** 영역에서 수행한다.
- 풋살: 세션 사진 업로드(기록용)
- 롤: 매치 결과창 스샷 업로드(집계용)
- 세션당 이미지 최대 10장(롤/풋살 공통)

---

## 9. 권한/토큰(세션 단위)

- 세션은 토큰을 가진다:
  - `editorToken`: 링크 가진 사람(수정/삭제 가능)
  - `adminToken`: 개발자/운영 권한(잠금 해제, 토큰 회전 등)
- 삭제 권한: **editor/admin 모두 가능**

---

## 10. 통계(필수)

확정된 롤 Match 데이터를 기반으로 Friend별 통계를 제공한다:

- 승률
- 자주 이긴 챔피언(수동 입력 데이터 기반)
- 선호 라인(선택된 lane 기반)

---

# 유즈케이스

## UC-1. 세션 생성 및 공유

1. 사용자가 컨텐츠(롤 내전/풋살)를 선택
2. 날짜/시간을 1개 지정해 세션 생성
3. 생성된 세션 링크를 단톡방에 공유
4. 단톡방 멤버들이 링크로 접속

**기대 결과**

- 로그인 없이 세션 상세 페이지 접근 가능
- 링크 가진 사람 모두 수정 가능

---

## UC-2. 참가 상태 입력(개별/대리)

1. 사용자가 세션에 접속
2. 참가/불참/미정을 선택
3. 필요 시 다른 사람의 상태도 대신 업데이트

**기대 결과**

- 참가자 카운트가 즉시 반영됨

---

## UC-3. 진행 확정 → 로스터 확정

1. 세션이 진행 가능해지면 ‘진행 확정(Confirm)’ 클릭
2. 참가자가 모이면 ‘참가자 확정(Lock roster)’ 클릭

**기대 결과**

- 이후 팀 나누기/매치 준비가 자연스럽게 진행됨

---

## UC-4. 팀 나누기(롤/풋살 공통)

1. 로스터 확정 후 Team A/B로 팀 분배
2. 풋살은 여기서 끝(팀만 유지)
3. 롤은 매치를 생성하여 진행

**기대 결과**

- 세션 단위로 Team A/B가 1회 구성됨

---

## UC-5. 롤 매치 생성(팀 프리셋 복사)

1. 롤 세션에서 Match #1 생성
2. 세션 Team A/B 구성이 Match로 복사됨
3. 매치 시작 전 참가자들이 라인을 선택
4. 챔피언은 필요하면 수동 입력

**기대 결과**

- 세션 내 Match가 여러 개 생성 가능
- 매치마다 라인/챔피언이 기록됨

---

## UC-6. 롤 결과창 스샷 업로드 및 결과 확정

1. Match가 끝난 뒤 게임 종료 결과창 스샷 업로드(지원 포맷 1종)
2. 승/패 및 A↔Blue/Red 매핑을 스샷 기반으로 추출/표시
3. 사용자가 확인/수정 후 확정

**기대 결과**

- 확정된 Match만 집계에 포함
- 매치마다 진영(blue/red)은 변경될 수 있음

---

## UC-7. 풋살 기록 사진 업로드

1. 풋살 세션에서 사진을 업로드
2. 사진은 Attachments 영역에 저장됨(댓글 아님)

**기대 결과**

- 세션당 최대 10장 제한이 적용됨

---

## UC-8. 댓글로 커뮤니티 활성화

1. 세션 상세에서 텍스트 댓글 작성/삭제

**기대 결과**

- 텍스트만 가능(이미지 불가)
- editor/admin 모두 삭제 가능

---

## UC-9. Friend 통계 조회

1. 통계 화면에서 친구를 선택
2. 승률/주챔/선호 라인 조회

**기대 결과**

- 확정된 Match 데이터만 기준으로 통계 제공
- Friend는 전역 주소록 기준으로 누적됨
